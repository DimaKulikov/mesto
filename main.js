(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e){var n=e.data,r=e.templateSelector,o=e.imageClickHandler,i=e.deleteIconClickHandler,s=e.likeClickHandler,a=e.userId;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._templateSelector=r,this.id=n._id,this._likes=n.likes,this.owner=n.owner,this._name=n.name,this._link=n.link,this._isLiked=this._likes.some((function(e){return e._id===a})),this._imageClickHandler=o,this._deleteIconClickHandler=i,this._likeClickHandler=s,this._isOwnedByUser=this.owner._id===a}var n,r;return n=t,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.cloneNode(!0).querySelector(".card")}},{key:"_getElements",value:function(){this._element=this._getTemplate(),this._image=this._element.querySelector(".card__pic"),this._title=this._element.querySelector(".card__title"),this._likeBtn=this._element.querySelector(".card__like-btn"),this._removeBtn=this._element.querySelector(".card__remove-btn"),this._likeCount=this._element.querySelector(".card__like-count")}},{key:"_setEventListeners",value:function(){var e=this;this._likeBtn.addEventListener("click",(function(){e._likeClickHandler(e)})),this._image.addEventListener("click",(function(){e._imageClickHandler(e._name,e._link)})),this._isOwnedByUser&&this._removeBtn.addEventListener("click",(function(){e._deleteIconClickHandler(e)}))}},{key:"_toggleLikeButton",value:function(){this._isLiked=!this._isLiked,this._likeBtn.classList.toggle("card__like-btn_active")}},{key:"getIsLiked",value:function(){return this._isLiked}},{key:"removeCard",value:function(){this._element.remove(),this._element=null,this._image=null,this._title=null,this._likeBtn=null,this._removeBtn=null}},{key:"updateLike",value:function(e){this._likes=e.likes,this._likeCount.textContent=this._likes.length,this._toggleLikeButton()}},{key:"createCard",value:function(){return this._getElements(),this._image.src=this._link,this._image.alt=this._name,this._title.textContent=this._name,this._likeCount.textContent=this._likes.length,this._setEventListeners(),this._isOwnedByUser||this._removeBtn.remove(),this._isLiked&&this._likeBtn.classList.add("card__like-btn_active"),this._element}}])&&e(n.prototype,r),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._form=n,this._selectors=t}var t,r;return t=e,(r=[{key:"_showInputError",value:function(e,t){e.classList.add(this._selectors.inputErrorClass);var n=this._form.querySelector(".".concat(e.id,"-error"));n.textContent=t,n.classList.add(this._selectors.errorClass)}},{key:"_hideInputError",value:function(e){var t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._selectors.inputErrorClass),t.classList.remove(this._selectors.errorClass),t.textContent=""}},{key:"_isValid",value:function(e){if(e.validity.valid)this._hideInputError(e);else{var t=e.validationMessage;this._showInputError(e,t)}}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?(this._button.classList.add(this._selectors.inactiveButtonClass),this._button.disabled=!0):(this._button.classList.remove(this._selectors.inactiveButtonClass),this._button.disabled=!1)}},{key:"_inputChangeHandler",value:function(e){var t=e.target;this._errorContainer=this._form.querySelector(".".concat(t.id,"-error")),this._isValid(t),this._toggleButtonState()}},{key:"_submitHandler",value:function(e){e.preventDefault()}},{key:"_setEventListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(t){e._inputChangeHandler(t)}))})),this._form.addEventListener("submit",(function(t){e._submitHandler(t)})),this._form.addEventListener("reset",(function(){setTimeout((function(){e._toggleButtonState(),e._inputList.forEach((function(t){e._hideInputError(t)}))}),0)}))}},{key:"_getElements",value:function(){this._inputList=Array.from(this._form.querySelectorAll(this._selectors.inputSelector)),this._button=this._form.querySelector(this._selectors.submitButtonSelector)}},{key:"enableValidation",value:function(){this._getElements(),this._setEventListeners()}}])&&n(t.prototype,r),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){var n=t.renderer,r=t.containerSelector,o=t.initData;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._container=document.querySelector(r),this.initData=o,this._renderer=n}var t,n;return t=e,(n=[{key:"renderItems",value:function(e){var t=this;this._items=e,this._items.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&o(t.prototype,n),e}();function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._closeBtn=this._popup.querySelector(".popup__close-btn"),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.addEventListener("click",(function(t){(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close-btn"))&&e.close()}))}},{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}}])&&s(t.prototype,n),e}();function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e))._image=t._popup.querySelector(".popup__image"),t._subtitle=t._popup.querySelector(".popup__subtitle"),t}return t=s,(n=[{key:"open",value:function(e){var t=e.name,n=e.link;l(h(s.prototype),"open",this).call(this),this._image.src="#",this._image.src=n,this._subtitle.textContent=t}}])&&c(t.prototype,n),s}(a);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=k(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(r);if(o){var n=k(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function s(e){var t,n=e.popupSelector,r=e.submitHandler,o=e.submitButtonSelector,a=e.submitProgressText,u=e.formSelector,c=e.inputFieldSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,n))._submitHandler=r.bind(g(t)),t._form=t._popup.querySelector(u),t._submitButton=t._form.querySelector(o),t._submitButtonDefaultText=t._submitButton.textContent,t._submitButtonProgressText=a,t._inputs=t._form.querySelectorAll(c),t._data={},t}return t=s,(n=[{key:"close",value:function(){this._form.reset(),y(k(s.prototype),"close",this).call(this)}},{key:"getInputValues",value:function(){var e=this;return this._inputs.forEach((function(t){return e._data[t.name]=t.value})),this._data}},{key:"setEventListeners",value:function(){y(k(s.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",this._submitHandler)}},{key:"setInputValues",value:function(e){this._inputs.forEach((function(t){t.value=e[t.name]}))}},{key:"renderSubmitProgress",value:function(e){e?(this._submitButton.textContent=this._submitButtonProgressText,this._submitButton.disabled=!0):(this._submitButton.textContent=this._submitButtonDefaultText,this._submitButton.disabled=!1)}}])&&m(t.prototype,n),s}(a);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return L(this,e)});function s(e){var t,n=e.popupSelector,r=e.submitButtonSelector,o=e.submitProgressText,a=e.formSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,n))._form=t._popup.querySelector(a),t._submitButton=t._form.querySelector(r),t._submitButtonDefaultText=t._submitButton.textContent,t._submitButtonProgressText=o,t.submitHandler=function(){console.error("Delete handler wasn't set")},t}return t=s,(n=[{key:"setEventListeners",value:function(){var e=this;E(P(s.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault(),e.submitHandler()}))}},{key:"setSubmitAction",value:function(e){this.submitHandler=e}},{key:"renderSubmitProgress",value:function(e){e?(this._submitButton.textContent=this._submitButtonProgressText,this._submitButton.disabled=!0):(this._submitButton.textContent=this._submitButtonDefaultText,this._submitButton.disabled=!1)}}])&&C(t.prototype,n),s}(a);function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(t){var n=t.nameSelector,r=t.infoSelector,o=t.avatarSelector,i=t.avatarClickHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._nameContainer=document.querySelector(n),this._infoContainer=document.querySelector(r),this._avatarContainer=document.querySelector(o),this._avatarClickHandler=i,this._userData}var t,n;return t=e,(n=[{key:"_renderUserInfo",value:function(){this._nameContainer.textContent=this._userData.name,this._infoContainer.textContent=this._userData.about,this._avatarContainer.style.backgroundImage="url(".concat(this._userData.avatar,")")}},{key:"getUserInfo",value:function(){return{name:this._userData.name,about:this._userData.about}}},{key:"getUserId",value:function(){return this._userData._id}},{key:"updateUserData",value:function(e){this._userData=e,this._renderUserInfo()}},{key:"setEventListeners",value:function(){var e=this;this._avatarContainer.addEventListener("click",(function(){e._avatarClickHandler()}))}}])&&B(t.prototype,n),e}();function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D=function(){function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._headers=r,this.deleteLike=this.deleteLike.bind(this),this.putLike=this.putLike.bind(this)}var t,n;return t=e,(n=[{key:"_parseResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка запроса на сервер ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((function(t){return e._parseResponse(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseUrl+"/users/me",{headers:this._headers}).then((function(t){return e._parseResponse(t)}))}},{key:"updateUserInfo",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me",{headers:R(R({},this._headers),{},{"content-type":"application/json"}),method:"PATCH",body:JSON.stringify(e)}).then((function(e){return t._parseResponse(e)}))}},{key:"addCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards",{headers:R(R({},this._headers),{},{"content-type":"application/json"}),method:"POST",body:JSON.stringify(e)}).then((function(e){return t._parseResponse(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return t._parseResponse(e)}))}},{key:"putLike",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((function(e){return t._parseResponse(e)}))}},{key:"deleteLike",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return t._parseResponse(e)}))}},{key:"updateAvatar",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me/avatar",{headers:R(R({},this._headers),{},{"content-type":"application/json"}),method:"PATCH",body:JSON.stringify(e)}).then((function(e){return t._parseResponse(e)}))}}])&&q(t.prototype,n),e}();function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._container=document.querySelector(t),this._templateSelector=n}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.cloneNode(!0)}},{key:"isLoading",value:function(e){this._container.style.display=e?"block":"none"}},{key:"init",value:function(){this._container.style.display="none";var e=this._getTemplate();this._container.append(e)}}])&&H(t.prototype,n),e}(),A={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"form__submit_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_active"};function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var F=document.querySelector(".profile__edit-btn"),N=document.querySelector("form[name=profileEditForm]"),J=document.querySelector(".profile__add-btn"),M=document.querySelector("form[name=placeAddForm]"),z=document.querySelector("form[name=avatarEditForm]"),$=new r(A,N),G=new r(A,M),K=new r(A,z);$.enableValidation(),G.enableValidation(),K.enableValidation();var Q=new U(".cards__spinner","#spinner");Q.init(),Q.isLoading(!0);var W=new D({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-21",headers:{authorization:"a6be0e39-3b40-440d-b51a-2e6c0105cc3c"}}),X=new I({nameSelector:".profile__name",infoSelector:".profile__subtitle",avatarSelector:".profile__avatar",avatarClickHandler:function(){re.open()}});X.setEventListeners();var Y=new i({initData:[],renderer:function(e){var t=oe(X.getUserId(),e).createCard();Y.addItem(t)},containerSelector:".cards__list"});Promise.all([W.getInitialCards(),W.getUserInfo()]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}}(t,n)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];X.updateUserData(i),Y.renderItems(o.reverse())})).catch((function(e){return console.error("Ошибка получения карточек и данных пользователя: ",e)})).finally((function(){return Q.isLoading(!1)}));var Z=new S({submitButtonSelector:".form__submit",submitProgressText:"Сохранение...",formSelector:".form",inputFieldSelector:".form__input",popupSelector:".popup_profile-edit",submitHandler:function(){Z.renderSubmitProgress(!0),W.updateUserInfo(Z.getInputValues()).then((function(e){X.updateUserData(e),Z.close()})).catch((function(e){return console.error("Ошибка при обновлении данных пользователя:",e)})).finally((function(){Z.renderSubmitProgress(!1)}))}});Z.setEventListeners();var ee=new _(".popup_image");ee.setEventListeners();var te=new S({submitButtonSelector:".form__submit",submitProgressText:"Сохранение...",formSelector:".form",inputFieldSelector:".form__input",popupSelector:".popup_place-add",submitHandler:function(){var e=te.getInputValues();te.renderSubmitProgress(!0),W.addCard(e).then((function(e){var t=oe(X.getUserId(),e).createCard();Y.addItem(t),te.close()})).catch((function(e){console.error("Ошибка при добавлении карточки:",e)})).finally((function(){te.renderSubmitProgress(!1)}))}});te.setEventListeners();var ne=new j({popupSelector:".popup_place-remove",submitButtonSelector:".form__submit",submitProgressText:"Удаление...",formSelector:".form"});ne.setEventListeners();var re=new S({submitButtonSelector:".form__submit",submitProgressText:"Сохранение...",formSelector:".form",inputFieldSelector:".form__input",popupSelector:".popup_avatar-edit",submitHandler:function(){var e=re.getInputValues();re.renderSubmitProgress(!0),W.updateAvatar(e).then((function(e){X.updateUserData(e),re.close()})).catch((function(e){return console.error("Ошибка при обновлении аватара: ",e)})).finally((function(){re.renderSubmitProgress(!1)}))}});function oe(e,n){return new t({data:n,userId:e,templateSelector:"#card-template",imageClickHandler:function(){return ee.open(n)},deleteIconClickHandler:ie,likeClickHandler:se})}function ie(e){ne.setSubmitAction((function(){ne.renderSubmitProgress(!0),W.deleteCard(e.id).then((function(){e.removeCard(),ne.close()})).catch((function(e){return console.error("Ошибка при удалении карточки:",e)})).finally((function(){ne.renderSubmitProgress(!1)}))})),ne.open()}function se(e){(e.getIsLiked()?W.deleteLike:W.putLike)(e.id).then((function(t){e.updateLike(t)})).catch((function(e){return console.error("Ошибка при обработке лайка:",e)}))}re.setEventListeners(),F.addEventListener("click",(function(){Z.open(),Z.setInputValues(X.getUserInfo())})),J.addEventListener("click",(function(){te.open()}))})();